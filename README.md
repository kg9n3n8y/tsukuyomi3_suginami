# tsukuyomi3_suginami

競技かるたの読み札をブラウザで表示できる PWA「月読 ver.3」です。読み手練習時の進行を支援するため、札の表示順制御や余韻タイマー、使札一覧からの細かな絞り込み機能を備えています。

## デモ
- GitHub Pages: https://kg9n3n8y.github.io/tsukuyomi3_suginami/

## 主な機能
- `fudalist.js` に定義された百人一首の読み札を順番に表示
- 下の句をクリックすると前の札へ、上の句をクリックすると次の札へ移動
- 「使う札を設定」で、使札の個別ON/OFF、一括選択（記号／決まり字）や空札追加が可能
- 使札として追加した札には「空」マークを付与し、現在の選択枚数を常時表示
- 「読み札をシャッフル」ボタンで 3 首目以降を再シャッフル（序歌と最終句は固定）
- 余韻ボタンを押すと円形アニメーションで待機時間を可視化
- 表示中の札やシャッフル結果を `localStorage` に保存し、ブラウザ再訪問時に復元
- Service Worker によるオフライン対応とホーム画面追加（PWA）

## 使い方（Web 版）
1. 上記デモページを開きます。
2. 必要に応じて「使う札を設定」を押し、使札のオン／オフや一括選択を行います。
   - 左側・中央・右側のいずれかを選び、記号を5種類選択すると50枚をまとめて選択。
   - 決まり字（「1字」を含む）での一括選択も可能です。
   - ランダム追加枚数を指定すると、未選択札から「空」札として追加されます。
3. 設定が終わったら「読み札をシャッフル」ボタンで 3 首目以降を任意に並び替えます。
4. 読み上げに合わせて、下の句（戻る）・上の句（進む）をクリックして表示を切り替えます。
5. 余韻を取りたいタイミングでフローティングボタンを押すと、アニメーション終了後に自動で非表示になります。

## ローカルでの動作確認
Service Worker を有効にするには HTTP 経由で配信する必要があります。静的サーバーでの起動例を以下に示します。

```bash
# 依存関係は不要です。任意の静的サーバーを利用してください。
npx serve .
# または
npx http-server .
```

ブラウザで `http://localhost:3000`（使用するサーバーによってポートは異なります）へアクセスすると、Web版と同様に操作できます。

## データ更新
- 読み札の本文や装飾は `fudalist.js` に JSON 形式で定義されています。
- 順序を変更したい場合は、オブジェクト配列の並び替えや文言の修正を行ってください。
- HTML タグ（`<ruby>` など）もデータ内に含められるため、書式変更時はタグの整合性にご注意ください。

## ビルド・デプロイ
本アプリは静的ファイルのみで構成されています。変更内容を GitHub Pages ブランチへ反映することで公開版が更新されます。
